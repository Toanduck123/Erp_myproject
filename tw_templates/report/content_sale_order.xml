<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="sale.report_saleorder_document">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})"/>
            <div class="page" style="letter-spacing: 0.1em;
                font-family: Arial, Helvetica, sans-serif; line-height:1.6;
                font-size: 16px; letter-spacing: 1px">
                <div class="oe_structure"/>
                <div style="text-align: center;">

                    <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                        <span t-if="doc.state not in ['draft','sent']">
                            <h3 style="text-align: center;">ĐƠN HÀNG ssssss
                                <br/>
                                <i>(Sale Order #<span t-field="doc.name"/>)
                                </i>
                            </h3>
                            <div t-if="doc.date_order and doc.state in ['draft','sent']">
                                Ngày đặt hàng<i>(Sale Order Date)</i>:
                                <span t-field="doc.date_order"/>
                            </div>
                        </span>
                        <span t-if="doc.state in ['draft','sent']">
                            <h3 style="text-align: center;">BẢNG BÁO GIÁ
                                <br/>
                                (<i>Quotation</i> #
                                <span t-field="doc.name"/>)
                            </h3>
                            <div t-if="doc.date_order and doc.state in ['draft','sent']">
                                Ngày báo giá <i>&amp;nbsp;(Quotation Date)</i>:
                                <span t-field="doc.date_order"/>
                            </div>
                            <div t-if="doc.validity_date and doc.state in ['draft', 'sent']" class="col-xs-12">
                                <span>Báo giá có hiệu lực đến <i>&amp;nbsp;(Expiration Date)</i>: &amp;nbsp;
                                </span>
                                <span t-field="doc.validity_date"/>
                            </div>
                        </span>
                    </t>

                </div>
                <div class="row mt32">
                    <div class="col-md-12 mt32 mb16">
                        <h4 style="font-weight: bold;">THÔNG TIN KHÁCH HÀNG(CUSTOMER)</h4>
                        <div>
                            <div>
                                <b>Công ty (Company):</b>
                                <span t-field="doc.partner_id.name"/>
                            </div>
                            <div>
                                <b>Địa chỉ (Address):</b>
                                <span t-field="doc.partner_id.street"/>
                            </div>
                            <div>
                                <t t-if="doc.partner_id.vat">
                                    <b>MTS (Tax Code):</b>
                                    <span t-field="doc.partner_id.vat"/>
                                </t>
                                <t t-else=""></t>
                            </div>
                            <div>
                                <t t-if="doc.partner_shipping_id.name">
                                    <b>Tên người liên lạc (Contact):</b>
                                    <span t-field="doc.partner_shipping_id.name"/>
                                </t>
                                <t t-else=""></t>

                            </div>
                            <div>
                                <t t-if="doc.partner_shipping_id.street">
                                    <b>Địa chỉ giao hàng (Delivery address):</b>
                                    &amp;nbsp;<span t-field="doc.partner_shipping_id.street"/>&amp;nbsp;
                                </t>
                                <t t-if="doc.partner_shipping_id.street2">
                                    ,&amp;nbsp;
                                    <span t-field="doc.partner_shipping_id.street2"/>
                                </t>
                                <t t-if="doc.partner_shipping_id.city">
                                    ,&amp;nbsp;
                                    <span t-field="doc.partner_shipping_id.city"/>
                                </t>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-4">
                                <b>Điện thoại:</b>
                                <span t-field="doc.partner_shipping_id.phone"/>
                            </div>
                            <div class="col-xs-3">
                                <b>Di động:</b>
                                <span t-field="doc.partner_shipping_id.mobile"/>
                            </div>
                            <div class="col-xs-5">
                                <b>Email:</b>
                                <span t-field="doc.partner_shipping_id.email"/>
                            </div>
                        </div>
                        <!--                        <div>-->
                        <!--                            <t t-if="doc.partner_id.website">-->
                        <!--                                <b>Website:</b>-->
                        <!--                                <span t-field="doc.partner_id.website"/>-->
                        <!--                            </t>-->
                        <!--                            <t t-else=""></t>-->
                        <!--                        </div>-->


                        <h4 style="font-weight: bold;">THÔNG TIN NGƯỜI BÁN(SELLER)</h4>
                        <div>
                            <div>
                                <b>Liên hệ (Contact):</b>
                                <span t-field="doc.user_id"/>
                            </div>
                            <div class="row">
                                <div class="col-xs-4">
                                    <b>Điện thoại:</b>
                                    <span t-field="doc.company_id.phone"/>
                                </div>
                                <div class="col-xs-3">
                                    <b>Di động:</b>
                                    <span t-field="doc.company_id.phone_work"/>
                                </div>
                                <div class="col-xs-5">
                                    <b>Email:</b>
                                    <span t-field="doc.company_id.email"/>
                                </div>
                            </div>
                            <div class="row" id="informations">
                                <div t-if="doc.client_order_ref" class="col-xs-3">
                                    <span>Your Reference:</span>
                                    <span t-field="doc.client_order_ref"/>
                                </div>
                                <div t-if="doc.confirmation_date and doc.state not in ['draft','sent']"
                                     class="col-xs-12">
                                    <span>
                                        <b>Ngày bán&amp;nbsp;<i>(Date Ordered)</i>:
                                        </b>
                                    </span>
                                    <span t-field="doc.confirmation_date"/>
                                </div>
                                <div name="payment_term" t-if="doc.payment_term_id" class="col-xs-12">
                                    <span>
                                        <b>Điều kiện thanh toán&amp;nbsp;<i>(Payment Terms)</i>:
                                        </b>
                                    </span>
                                    <span t-field="doc.payment_term_id"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <b>CHI TIẾT ĐƠN HÀNG
                    <i>(ORDER LINES)</i>
                </b>
                <!-- Is there a discount on at least one line? -->
                <!--                <t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>-->
                <t t-foreach="doc.order_lines_layouted()" t-as="page">
                    <table class="table table-condensed">
                        <thead>
                            <tr>
                                <th>Sản phẩm
                                    <i>(Product)</i>
                                </th>
                                <th class="text-right">Số lượng
                                    <br/>
                                    <i>(Quantity)</i>
                                </th>
                                <th class="text-right">Đơn giá
                                    <br/>
                                    <i>(Unit Price)</i>
                                </th>
                                <th t-if="display_discount" class="text-right" groups="sale.group_discount_per_so_line">
                                    Giảm giá
                                    <br/>
                                    <i>(Disc)</i>
                                    <i>(%)</i>
                                </th>
                                <th class="text-right">Thuế
                                    <i>(Taxes)</i>
                                </th>
                                <th class="text-right" groups="sale.group_show_price_subtotal">Thành tiền
                                    <br/>
                                    <i>(Amount)</i>
                                </th>
                                <th class="text-right price_tax_included" groups="sale.group_show_price_total">Tổng tiền
                                    <br/>
                                    <i>(Total)</i>
                                    Price
                                </th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">
                            <t t-foreach="page" t-as="layout_category">

                                <t t-if="layout_category_size > 1 or page_size > 1" groups="sale.group_sale_layout">
                                    <tr class="active">
                                        <td colspan="7" style="font-weight: bold; border-bottom: 1px solid black;">&amp;bull;
                                            <t t-esc="layout_category['name']"/>
                                        </td>
                                    </tr>
                                </t>

                                <!-- Lines associated -->
                                <t t-foreach="layout_category['lines']" t-as="l">
                                    <tr>
                                        <td>
                                            <span t-field="l.name"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="l.product_uom_qty"/>
                                            <span t-field="l.product_uom" groups="product.group_uom"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="l.price_unit"/>
                                        </td>
                                        <td t-if="display_discount" class="text-right"
                                            groups="sale.group_discount_per_so_line">
                                            <span t-field="l.discount"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="', '.join(map(lambda x: (x.description or x.name), l.tax_id))"/>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_subtotal">
                                            <span t-field="l.price_subtotal"
                                                  t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                        </td>
                                        <td class="text-right" groups="sale.group_show_price_total">
                                            <span t-field="l.price_total"
                                                  t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-if="(layout_category_size > 1 or page_size > 1) and layout_category['subtotal']"
                                   groups="sale.group_sale_layout">
                                    <tr class="text-right">
                                        <td colspan="6">
                                            <b>Thành tiền
                                                <i>(Subtotal:)</i>
                                            </b>
                                            <t t-set="subtotal"
                                               t-value="sum(line.price_subtotal for line in layout_category['lines'])"/>
                                            <span t-esc="subtotal"
                                                  t-options="{'widget': 'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                        </td>
                                    </tr>
                                </t>

                            </t>
                        </tbody>
                    </table>

                    <t t-if="page_index &lt; page_size - 1" groups="sale.group_sale_layout">
                        <p style="page-break-before:always;"></p>
                    </t>
                </t>
                <div class="clearfix">
                    <div class="row" name="total">
                        <div class="col-xs-5 pull-right">
                            <table class="table table-condensed" style="min-width: 200px; max-width: 350px;">
                                <tr class="border-black" style="border-bottom:1px solid #dddddd;">
                                    <td>
                                        <b>Tổng tiền trước thuế
                                            <i>(Subtotal)</i>
                                        </b>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="doc.amount_untaxed" t-options='{"widget": "monetary",
                                              "display_currency": doc.pricelist_id.currency_id}'/>
                                    </td>
                                </tr>
                                <t t-foreach="doc._get_tax_amount_by_group()" t-as="amount_by_group">
                                    <tr style="border-bottom:1px solid #dddddd;">
                                        <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                            <td>
                                                <span t-esc="amount_by_group[0]"/>
                                                <!--                                                <span>&amp;nbsp;<span>on</span>&amp;nbsp;-->
                                                <!--                                                    <t t-esc="amount_by_group[2]" t-options='{"widget": "monetary",-->
                                                <!--                                                       "display_currency": doc.pricelist_id.currency_id}'/>-->
                                                <!--                                                </span>-->
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="amount_by_group[1]" t-options='{"widget": "monetary",
                                                      "display_currency": doc.pricelist_id.currency_id}'/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td>
                                                <span t-esc="amount_by_group[0]"/>
                                            </td>
                                            <td class="text-right">
                                                <span t-esc="amount_by_group[1]" t-options='{"widget": "monetary",
                                                      "display_currency": doc.pricelist_id.currency_id}'/>
                                            </td>
                                        </t>
                                    </tr>
                                </t>
                                <tr class="border-black">
                                    <td>
                                        <b>Tổng tiền
                                            <i>(Total)</i>
                                        </b>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="doc.amount_total"
                                              t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <!--                <p t-field="doc.note"/>-->
                <!--                <p t-if="doc.payment_term_id.note">-->
                <!--                    <span t-field="doc.payment_term_id.note"/>-->
                <!--                </p>-->
                <p id="fiscal_position_remark" t-if="doc.fiscal_position_id and doc.fiscal_position_id.note">
                    <b>Fiscal Position Remark:</b>
                    <span t-field="doc.fiscal_position_id.note"/>
                </p>
                <div class="oe_structure"/>
            </div>
        </t>
    </template>

</odoo>
